/*! For license information please see b9bf92d7.5a0e8fe8.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[54766],{148746:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var i=n(474848),o=n(28453);const r={id:"provider",title:"Guest Authentication Provider",sidebar_label:"Guest",description:"Adding a guest authentication provider in Backstage"},s=void 0,a={id:"auth/guest/provider",title:"Guest Authentication Provider",description:"Adding a guest authentication provider in Backstage",source:"@site/../docs/auth/guest/provider.md",sourceDirName:"auth/guest",slug:"/auth/guest/provider",permalink:"/docs/next/auth/guest/provider",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/auth/guest/provider.md",tags:[],version:"current",frontMatter:{id:"provider",title:"Guest Authentication Provider",sidebar_label:"Guest",description:"Adding a guest authentication provider in Backstage"},sidebar:"docs",previous:{title:"Google IAP",permalink:"/docs/next/auth/google/gcp-iap-auth"},next:{title:"Okta",permalink:"/docs/next/auth/okta/provider"}},d={},l=[{value:"Summary",id:"summary",level:2},{value:"Installation",id:"installation",level:2},{value:"Backend",id:"backend",level:3},{value:"Frontend",id:"frontend",level:3},{value:"Config",id:"config",level:3}];function c(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"Audience: Admins or developers"}),"\n",(0,i.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(t.p,{children:"The goal of this guide is to get you set up with a guest authentication provider that emits tokens. This is different than the old guest authentication that is purely stored on the frontend and does not have tokens. The main reason you'd want to use this provider is to use permissioned plugins."}),"\n",(0,i.jsx)(t.admonition,{type:"caution",children:(0,i.jsxs)(t.p,{children:["This provider should only ever be enabled for ",(0,i.jsx)(t.code,{children:"development"}),". To prevent unauthorized access to your data, this package is ",(0,i.jsx)(t.em,{children:"explicitly"})," disabled for non-development environments."]})}),"\n",(0,i.jsx)(t.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(t.h3,{id:"backend",children:"Backend"}),"\n",(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsx)(t.p,{children:"This will only work with the new backend system. There is no support for this in the old backend."})}),"\n",(0,i.jsxs)(t.p,{children:["Add the ",(0,i.jsx)(t.code,{children:"@backstage/plugin-auth-backend-module-guest-provider"})," to your backend installation."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",metastring:'title="From your Backstage root directory"',children:"yarn --cwd packages/backend add @backstage/plugin-auth-backend-module-guest-provider\n"})}),"\n",(0,i.jsx)(t.p,{children:"Then, add it to your backend's source,"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",metastring:'title="packages/backend/src/index.ts"',children:"const backend = createBackend();\n\nbackend.add(import('@backstage/plugin-auth-backend'));\n// highlight-add-next-line\nbackend.add(import('@backstage/plugin-auth-backend-module-guest-provider'));\n\nawait backend.start();\n"})}),"\n",(0,i.jsx)(t.h3,{id:"frontend",children:"Frontend"}),"\n",(0,i.jsxs)(t.p,{children:["Add the following to your ",(0,i.jsx)(t.code,{children:"SignInPage"})," providers,"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-ts",children:"const providers = [\n  // highlight-add-next-line\n  'guest',\n  ...\n]\n"})}),"\n",(0,i.jsx)(t.h3,{id:"config",children:"Config"}),"\n",(0,i.jsxs)(t.p,{children:["Similar to the other authentication providers, you have to enable the provider in config. Add the following to your ",(0,i.jsx)(t.code,{children:"app-config.local.yaml"}),","]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'title="app-config.local.yaml"',children:"auth:\n  providers:\n    # highlight-add-next-line\n    guest: {}\n"})}),"\n",(0,i.jsx)(t.p,{children:"The above is all you need to get working with the guest provider. However, you can also add additional configuration if you need to such as the following:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'title="app-config.local.yaml"',children:"auth:\n  providers:\n    guest:\n      userEntityRef: user:default/john-smith\n      ownershipEntityRefs: [group:default/smith-family]\n      dangerouslyAllowOutsideDevelopment: false\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"userEntityRef"})," is used as the entity reference for the guest user and the ",(0,i.jsx)(t.code,{children:"ownershipEntityRefs"})," is a list of entity references to use for ownership of the guest user, if the user is not found in the catalog."]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"dangerouslyAllowOutsideDevelopment"})," flag is used to allow users to sign in with the guest provider outside of their development environments, e.g. in production."]}),"\n",(0,i.jsxs)(t.p,{children:["You can find this information by looking at the config file ",(0,i.jsx)(t.a,{href:"https://github.com/backstage/backstage/blob/master/plugins/auth-backend-module-guest-provider/config.d.ts",children:"here"}),"."]})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},221020:(e,t,n)=>{var i=n(296540),o=Symbol.for("react.element"),r=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var i,r={},l=null,c=null;for(i in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(c=t.ref),t)s.call(t,i)&&!d.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:o,type:e,key:l,ref:c,props:r,_owner:a.current}}t.Fragment=r,t.jsx=l,t.jsxs=l},474848:(e,t,n)=>{e.exports=n(221020)},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>a});var i=n(296540);const o={},r=i.createContext(o);function s(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);